<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¶é—´æ¼”åŒ–æ—…è¡Œç®—æ³• (TETA) äº¤äº’å¼è§£æ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Custom Config & Styles -->
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f5f5f4; 
        }
        ::-webkit-scrollbar-thumb {
            background: #d6d3d1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a29e; 
        }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }

        /* Logic Card Transitions */
        .logic-card {
            transition: all 0.3s ease;
        }
        .logic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .active-tab {
            border-bottom: 2px solid #ea580c; /* orange-600 */
            color: #ea580c;
            font-weight: 600;
        }
    </style>

    <!-- 
    ================================================================================
    PLACEHOLDERS & META INFO
    ================================================================================
    -->

    <!-- Chosen Palette: "Chronos Warmth" - Base: Stone/Warm Gray (bg-stone-50). Text: Stone-800. Accents: Amber/Orange (amber-600, orange-500) representing time and energy. Secondary: Slate Blue for contrast in charts. -->

    <!-- Application Structure Plan: 
         1. Hero Section: High-level hook explaining TETA as a nature-inspired optimization method.
         2. Conceptual Framework (The "Why"): Interactive cards explaining the Past, Present, and Future strategies. This breaks the math down into logic.
         3. Live Simulation (The "How"): A Plotly-based 2D contour map. Users can run a simplified TETA simulation to see "travelers" converging on a minimum. This provides the "Wow" factor and intuitive understanding of convergence.
         4. Performance Lab (The "Result"): Interactive Chart.js graphs comparing TETA against PSO and GA. Users can toggle metrics (Accuracy vs. Speed).
         5. Technical Implementation: A summary of the pseudo-code logic for developers.
         Rationale: This flow moves from Abstract -> Visual -> Empirical -> Technical, catering to different learning styles.
    -->

    <!-- Visualization & Content Choices:
         1. Concept Cards: HTML/CSS Grid. Goal: Explain the 3 movement strategies. Interaction: Hover/Click to reveal specific algorithmic logic. No SVG needed.
         2. Simulation: Plotly.js Contour Plot. Goal: Show optimization in real-time. Interaction: Play/Pause/Reset. Justification: Plotly handles coordinate updates efficiently for 50+ agents.
         3. Comparison Charts: Chart.js Line & Radar Charts. Goal: Compare benchmarks. Interaction: Dataset toggling. Justification: Standard industry way to show algorithm performance.
         4. Flow Diagram: CSS-styled Flexbox with arrows (unicode). Goal: Show execution order.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-stone-50 text-stone-800 font-sans antialiased leading-relaxed selection:bg-orange-200">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-stone-50/90 backdrop-blur-md border-b border-stone-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0 flex items-center gap-2">
                    <span class="text-2xl text-orange-600">â³</span>
                    <span class="font-bold text-xl tracking-tight text-stone-800">TETA <span class="text-stone-500 font-normal text-sm hidden sm:inline">| æ—¶é—´æ¼”åŒ–æ—…è¡Œç®—æ³•</span></span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <button onclick="scrollToSection('concept')" class="text-stone-600 hover:text-orange-600 transition-colors">æ ¸å¿ƒæ¦‚å¿µ</button>
                    <button onclick="scrollToSection('simulation')" class="text-stone-600 hover:text-orange-600 transition-colors">å®æ—¶æ¨¡æ‹Ÿ</button>
                    <button onclick="scrollToSection('benchmark')" class="text-stone-600 hover:text-orange-600 transition-colors">æ€§èƒ½å¯¹æ¯”</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative overflow-hidden pt-12 pb-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold text-stone-900 mb-6">
                ç©¿è¶Šæ—¶é—´çš„<span class="text-orange-600">å¯»ä¼˜ä¹‹æ—…</span>
            </h1>
            <p class="mt-4 max-w-2xl mx-auto text-xl text-stone-600">
                æ—¶é—´æ¼”åŒ–æ—…è¡Œç®—æ³• (TETA) æ˜¯ä¸€ç§å—ç‰©ç†å’Œå†å²æ¼”åŒ–å¯å‘çš„å…ƒå¯å‘å¼ç®—æ³•ã€‚å®ƒæ¨¡æ‹Ÿä¸ªä½“åœ¨â€œè¿‡å»â€ã€â€œç°åœ¨â€å’Œâ€œæœªæ¥â€ä¹‹é—´çš„ç©¿æ¢­ï¼Œä»¥åœ¨å¤æ‚çš„æ•°å­¦ç©ºé—´ä¸­å¯»æ‰¾å…¨å±€æœ€ä¼˜è§£ã€‚
            </p>
            <div class="mt-10 flex justify-center gap-4">
                <button onclick="scrollToSection('simulation')" class="px-8 py-3 bg-orange-600 text-white rounded-lg font-semibold shadow-lg hover:bg-orange-700 transition-all transform hover:-translate-y-1">
                    å¯åŠ¨æ¨¡æ‹Ÿ ğŸš€
                </button>
                <button onclick="scrollToSection('concept')" class="px-8 py-3 bg-white text-stone-700 border border-stone-300 rounded-lg font-semibold hover:bg-stone-100 transition-all">
                    äº†è§£åŸç† ğŸ“–
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-24 pb-20">

        <!-- SECTION 1: CORE CONCEPTS -->
        <section id="concept" class="scroll-mt-24">
            <div class="mb-10 text-center md:text-left">
                <h2 class="text-3xl font-bold text-stone-900 border-l-4 border-orange-500 pl-4 inline-block">ç®—æ³•æ ¸å¿ƒé€»è¾‘</h2>
                <p class="mt-4 text-stone-600 max-w-3xl">
                    TETA å¹¶ä¸ä¾èµ–å•çº¯çš„éšæœºæ¸¸èµ°ã€‚å®ƒå°†ç§ç¾¤å®šä¹‰ä¸ºâ€œæ—¶é—´æ—…è¡Œè€…â€ï¼Œé€šè¿‡ä¸‰ç§ä¸åŒçš„ç­–ç•¥æ›´æ–°ä½ç½®ï¼Œæ¨¡æ‹Ÿä»å†å²ç»éªŒä¸­å­¦ä¹ ã€åœ¨å½“ä¸‹ç«äº‰ä»¥åŠå¯¹æœªæ¥æ¢ç´¢çš„è¿‡ç¨‹ã€‚
                    <br><span class="text-sm text-stone-500">ç‚¹å‡»ä¸‹æ–¹å¡ç‰‡æŸ¥çœ‹è¯¦ç»†ç­–ç•¥ï¼š</span>
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Past Strategy -->
                <div class="logic-card bg-white rounded-xl shadow-sm border border-stone-200 p-6 cursor-pointer" onclick="updateLogicDetail('past')">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-stone-800">1. è¿½æº¯è¿‡å» (Past)</h3>
                        <span class="text-2xl bg-blue-100 p-2 rounded-lg">ğŸ“œ</span>
                    </div>
                    <p class="text-stone-600 text-sm mb-4">æ—…è¡Œè€…å›é¡¾è‡ªå·±çš„å†å²æœ€ä½³ä½ç½®ã€‚</p>
                    <div class="h-1 w-full bg-stone-100 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 w-1/3"></div>
                    </div>
                </div>

                <!-- Present Strategy -->
                <div class="logic-card bg-white rounded-xl shadow-sm border border-stone-200 p-6 cursor-pointer border-orange-200 ring-2 ring-orange-100" onclick="updateLogicDetail('present')">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-stone-800">2. ç«‹è¶³ç°åœ¨ (Present)</h3>
                        <span class="text-2xl bg-orange-100 p-2 rounded-lg">ğŸ“</span>
                    </div>
                    <p class="text-stone-600 text-sm mb-4">å‘å½“å‰ç§ç¾¤ä¸­çš„æœ€ä½³ä¸ªä½“ï¼ˆå…¨å±€æœ€ä¼˜ï¼‰é æ‹¢ã€‚</p>
                    <div class="h-1 w-full bg-stone-100 rounded-full overflow-hidden">
                        <div class="h-full bg-orange-500 w-2/3"></div>
                    </div>
                </div>

                <!-- Future Strategy -->
                <div class="logic-card bg-white rounded-xl shadow-sm border border-stone-200 p-6 cursor-pointer" onclick="updateLogicDetail('future')">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-stone-800">3. æ¢ç´¢æœªæ¥ (Future)</h3>
                        <span class="text-2xl bg-purple-100 p-2 rounded-lg">ğŸš€</span>
                    </div>
                    <p class="text-stone-600 text-sm mb-4">éšæœºæ‰°åŠ¨ä¸æ¢ç´¢ï¼Œé¿å…é™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚</p>
                    <div class="h-1 w-full bg-stone-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-500 w-1/4"></div>
                    </div>
                </div>
            </div>

            <!-- Dynamic Detail Box -->
            <div class="mt-8 bg-stone-800 text-stone-50 rounded-xl p-8 shadow-inner relative transition-all duration-300" id="logic-detail-box">
                <div class="absolute top-4 right-4 text-stone-600 text-4xl opacity-20">Æ’(x)</div>
                <h4 class="text-xl font-bold text-orange-400 mb-2" id="detail-title">ç­–ç•¥ï¼šç«‹è¶³ç°åœ¨</h4>
                <p class="text-stone-300 leading-relaxed" id="detail-desc">
                    è¿™æ˜¯ TETA çš„ä¸»è¦æ”¶æ•›æœºåˆ¶ã€‚ä¸ªä½“è§‚å¯Ÿå½“å‰çš„å…¨å±€æœ€ä¼˜è§£ï¼ˆBest Globalï¼‰ï¼Œå¹¶è®¡ç®—å‘é‡å·®ã€‚è¿™ç±»ä¼¼äºç²’å­ç¾¤ç®—æ³•ï¼ˆPSOï¼‰ä¸­çš„ç¤¾ä¼šè®¤çŸ¥éƒ¨åˆ†ï¼Œç¡®ä¿ç§ç¾¤å¿«é€Ÿå‘å·²çŸ¥çš„æœ€æœ‰æ½œåŠ›çš„åŒºåŸŸèšé›†ã€‚
                </p>
                <div class="mt-4 pt-4 border-t border-stone-700 font-mono text-sm text-green-400" id="detail-math">
                    New_Pos = Current_Pos + rand() * (Global_Best - Current_Pos)
                </div>
            </div>
        </section>

        <!-- SECTION 2: INTERACTIVE SIMULATION -->
        <section id="simulation" class="scroll-mt-24 bg-white rounded-2xl shadow-lg border border-stone-200 overflow-hidden">
            <div class="p-6 md:p-8 border-b border-stone-100">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <h2 class="text-2xl font-bold text-stone-900 flex items-center gap-2">
                            <span class="text-orange-600">âš¡</span> å®æ—¶å¯»ä¼˜æ¨¡æ‹Ÿ
                        </h2>
                        <p class="mt-1 text-stone-500 text-sm">
                            è§‚å¯Ÿ TETA ç®—æ³•åœ¨äºŒç»´ Rastrigin å‡½æ•°ï¼ˆå¤šå³°å€¼å¤æ‚å‡½æ•°ï¼‰ä¸Šçš„æ”¶æ•›è¿‡ç¨‹ã€‚ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸­å¿ƒçš„æœ€æ·±è“è‰²åŒºåŸŸ (0,0)ã€‚
                        </p>
                    </div>
                    <div class="flex gap-2">
                        <button id="sim-start-btn" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded shadow text-sm font-medium transition-colors">â–¶ å¼€å§‹</button>
                        <button id="sim-reset-btn" class="px-4 py-2 bg-stone-200 hover:bg-stone-300 text-stone-700 rounded shadow text-sm font-medium transition-colors">â†º é‡ç½®</button>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-4">
                <!-- Controls Sidebar -->
                <div class="p-6 bg-stone-50 border-r border-stone-100 lg:col-span-1 space-y-6">
                    <div>
                        <label class="block text-xs font-bold text-stone-500 uppercase tracking-wide mb-2">å½“å‰è¿­ä»£ (Epoch)</label>
                        <div class="text-3xl font-mono text-stone-900" id="sim-epoch">0</div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-stone-500 uppercase tracking-wide mb-2">å…¨å±€æœ€ä¼˜é€‚åº”åº¦</label>
                        <div class="text-lg font-mono text-green-600" id="sim-fitness">Infinity</div>
                    </div>
                    
                    <hr class="border-stone-200">

                    <div>
                        <label class="block text-xs font-bold text-stone-500 uppercase tracking-wide mb-2">ç§ç¾¤çŠ¶æ€</label>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-stone-600">æ¢ç´¢ä¸­ (Future)</span>
                                <span class="font-bold text-purple-600" id="count-future">10%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-stone-600">æ”¶æ•›ä¸­ (Present)</span>
                                <span class="font-bold text-orange-600" id="count-present">80%</span>
                            </div>
                            <div class="w-full bg-stone-200 rounded-full h-2 mt-1">
                                <div class="bg-orange-500 h-2 rounded-full" style="width: 80%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="p-3 bg-blue-50 rounded text-xs text-blue-800 border border-blue-100">
                        <strong>æç¤ºï¼š</strong> å¦‚æœç‚¹åˆ†æ•£å¼€ï¼Œè¯´æ˜æ­£åœ¨è¿›è¡Œâ€œæœªæ¥æ¢ç´¢â€ä»¥è·³å‡ºå±€éƒ¨æœ€ä¼˜ï¼›å¦‚æœèšæ‹¢ï¼Œè¯´æ˜æ­£åœ¨è¿›è¡Œâ€œç°åœ¨åˆ©ç”¨â€ã€‚
                    </div>
                </div>

                <!-- Visualization Area -->
                <div class="lg:col-span-3 bg-white p-4">
                    <!-- Plotly Container -->
                    <div id="plotly-div" class="w-full h-[400px] md:h-[500px]"></div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: BENCHMARK DATA -->
        <section id="benchmark" class="scroll-mt-24">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-stone-900 border-l-4 border-orange-500 pl-4 inline-block">æ€§èƒ½åŸºå‡†æµ‹è¯•</h2>
                <p class="mt-4 text-stone-600">
                    åŸºäº MQL5 æ–‡ç« ä¸­çš„æ ‡å‡†æµ‹è¯•å‡½æ•°ç»“æœï¼Œå¯¹æ¯” TETA ä¸ç»å…¸ç®—æ³•ï¼ˆPSO - ç²’å­ç¾¤ï¼ŒGA - é—ä¼ ç®—æ³•ï¼‰çš„è¡¨ç°ã€‚
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Convergence Chart -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <div class="mb-4">
                        <h3 class="text-lg font-bold text-stone-800">æ”¶æ•›é€Ÿåº¦å¯¹æ¯” (Log Scale)</h3>
                        <p class="text-xs text-stone-500">å‡½æ•°: Ackley | ç»´åº¦: 30 | è¶Šä½è¶Šå¥½</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="convergenceChart"></canvas>
                    </div>
                </div>

                <!-- Radar Analysis -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <div class="mb-4">
                        <h3 class="text-lg font-bold text-stone-800">ç»¼åˆèƒ½åŠ›è¯„ä¼°</h3>
                        <p class="text-xs text-stone-500">åŸºäºå¤šé¡¹æµ‹è¯•å‡½æ•°çš„ç»¼åˆè¯„åˆ†</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Key Findings Text -->
            <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-orange-50 p-4 rounded-lg border border-orange-100">
                    <h4 class="font-bold text-orange-800 mb-2">ğŸ† æ”¶æ•›ç²¾åº¦</h4>
                    <p class="text-sm text-stone-700">TETA åœ¨é«˜ç»´å¤šå³°å‡½æ•°ä¸Šè¡¨ç°å‡ºæ›´å¼ºçš„è·³å‡ºå±€éƒ¨æœ€ä¼˜çš„èƒ½åŠ›ï¼Œæœ€ç»ˆè§£çš„ç²¾åº¦é€šå¸¸ä¼˜äºæ ‡å‡† PSOã€‚</p>
                </div>
                <div class="bg-stone-100 p-4 rounded-lg border border-stone-200">
                    <h4 class="font-bold text-stone-800 mb-2">â±ï¸ è®¡ç®—ç¨³å®šæ€§</h4>
                    <p class="text-sm text-stone-700">ç”±äºå¼•å…¥äº†â€œè¿‡å»â€è®°å¿†æœºåˆ¶ï¼Œç®—æ³•åœ¨è¿­ä»£åæœŸçš„éœ‡è¡è¾ƒå°ï¼Œæ”¶æ•›æ›²çº¿æ›´å¹³æ»‘ã€‚</p>
                </div>
                <div class="bg-stone-100 p-4 rounded-lg border border-stone-200">
                    <h4 class="font-bold text-stone-800 mb-2">âš™ï¸ å‚æ•°æ•æ„Ÿæ€§</h4>
                    <p class="text-sm text-stone-700">TETA åªæœ‰ä¸¤ä¸ªä¸»è¦å‚æ•°ï¼ˆç§ç¾¤å¤§å°ã€ç­–ç•¥æ¦‚ç‡ï¼‰ï¼Œç›¸æ¯” GA æ›´æ˜“äºè°ƒä¼˜å’Œéƒ¨ç½²ã€‚</p>
                </div>
            </div>
        </section>

        <!-- SECTION 4: ALGORITHM FLOW -->
        <section class="bg-stone-800 text-stone-200 rounded-2xl p-8 md:p-12 text-center">
            <h2 class="text-2xl font-bold text-white mb-8">ç®—æ³•æ‰§è¡Œæµç¨‹</h2>
            <div class="flex flex-col md:flex-row justify-center items-center gap-4 text-sm">
                
                <div class="bg-stone-700 p-4 rounded-lg w-full md:w-48 border border-stone-600">
                    <div class="text-2xl mb-2">ğŸ²</div>
                    <div class="font-bold text-orange-400">åˆå§‹åŒ–</div>
                    <div class="text-stone-400 text-xs mt-1">éšæœºç”Ÿæˆç§ç¾¤</div>
                </div>

                <div class="text-stone-500 text-2xl hidden md:block">âœ</div>
                <div class="text-stone-500 text-2xl block md:hidden">â¬‡</div>

                <div class="bg-stone-700 p-4 rounded-lg w-full md:w-48 border border-stone-600">
                    <div class="text-2xl mb-2">âš–ï¸</div>
                    <div class="font-bold text-orange-400">é€‚åº”åº¦è¯„ä¼°</div>
                    <div class="text-stone-400 text-xs mt-1">è®¡ç®—ç›®æ ‡å‡½æ•°å€¼</div>
                </div>

                <div class="text-stone-500 text-2xl hidden md:block">âœ</div>
                <div class="text-stone-500 text-2xl block md:hidden">â¬‡</div>

                <div class="bg-stone-700 p-4 rounded-lg w-full md:w-48 border border-stone-600 ring-2 ring-orange-500">
                    <div class="text-2xl mb-2">â³</div>
                    <div class="font-bold text-white">æ—¶é—´æ¼”åŒ–</div>
                    <div class="text-stone-400 text-xs mt-1">é€‰æ‹©ç­–ç•¥ (è¿‡å»/ç°åœ¨/æœªæ¥)</div>
                </div>

                <div class="text-stone-500 text-2xl hidden md:block">âœ</div>
                <div class="text-stone-500 text-2xl block md:hidden">â¬‡</div>

                <div class="bg-stone-700 p-4 rounded-lg w-full md:w-48 border border-stone-600">
                    <div class="text-2xl mb-2">ğŸ›‘</div>
                    <div class="font-bold text-orange-400">ç»ˆæ­¢åˆ¤æ–­</div>
                    <div class="text-stone-400 text-xs mt-1">è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Ÿ</div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white border-t border-stone-200 py-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-stone-500 text-sm">
                åŸºäº MQL5 ç¤¾åŒºæ–‡ç«  "Time Evolution Travel Algorithm (TETA)" ç”Ÿæˆçš„äº¤äº’å¼æ¼”ç¤ºã€‚<br>
                æ­¤é¡µé¢ç”¨äºæ•™è‚²ä¸ç®—æ³•å¯è§†åŒ–ç›®çš„ã€‚
            </p>
        </div>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- Navigation Logic ---
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // --- Section 1: Content Logic (Concept Cards) ---
        const logicData = {
            past: {
                title: "ç­–ç•¥ï¼šè¿½æº¯è¿‡å» (History Recall)",
                desc: "åœ¨è¿™ä¸ªé˜¶æ®µï¼Œç®—æ³•åˆ©ç”¨è®°å¿†æœºåˆ¶ã€‚å¦‚æœå½“å‰ä½ç½®ä¸å¦‚å†å²æœ€ä½³ä½ç½®ï¼ˆpBestï¼‰ï¼Œæ—…è¡Œè€…ä¼šå°è¯•å‘è‡ªå·±çš„å†å²æœ€ä½³ä½ç½®ç§»åŠ¨ã€‚è¿™ä¿è¯äº†ç®—æ³•ä¸ä¼šè½»æ˜“ä¸¢å¤±å·²å‘ç°çš„ä¼˜è´¨è§£ï¼Œå¢åŠ äº†é²æ£’æ€§ã€‚",
                math: "New_Pos = rand() * (Best_History_Pos - Current_Pos) + Current_Pos",
                color: "text-blue-400"
            },
            present: {
                title: "ç­–ç•¥ï¼šç«‹è¶³ç°åœ¨ (Global Competition)",
                desc: "è¿™æ˜¯ TETA çš„ä¸»è¦æ”¶æ•›æœºåˆ¶ã€‚ä¸ªä½“è§‚å¯Ÿå½“å‰çš„å…¨å±€æœ€ä¼˜è§£ï¼ˆBest Globalï¼‰ï¼Œå¹¶è®¡ç®—å‘é‡å·®ã€‚è¿™ç±»ä¼¼äºç²’å­ç¾¤ç®—æ³•ï¼ˆPSOï¼‰ä¸­çš„ç¤¾ä¼šè®¤çŸ¥éƒ¨åˆ†ï¼Œç¡®ä¿ç§ç¾¤å¿«é€Ÿå‘å·²çŸ¥çš„æœ€æœ‰æ½œåŠ›çš„åŒºåŸŸèšé›†ã€‚",
                math: "New_Pos = Current_Pos + rand() * (Global_Best - Current_Pos)",
                color: "text-orange-400"
            },
            future: {
                title: "ç­–ç•¥ï¼šæ¢ç´¢æœªæ¥ (Random Exploration)",
                desc: "ä¸ºäº†é˜²æ­¢é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼ˆLocal Minimaï¼‰ï¼Œç®—æ³•å¼•å…¥éšæœºæ‰°åŠ¨ã€‚æ—…è¡Œè€…å‡è®¾æœªæ¥æ˜¯ä¸ç¡®å®šçš„ï¼Œå› æ­¤å‘éšæœºæ–¹å‘è¿›è¡Œçªå˜ç§»åŠ¨ã€‚è¿™åœ¨æœç´¢åˆæœŸéå¸¸é‡è¦ï¼Œèƒ½æ‰©å¤§æœç´¢èŒƒå›´ã€‚",
                math: "New_Pos = Global_Best + (Upper_Bound - Lower_Bound) * random_coefficient",
                color: "text-purple-400"
            }
        };

        function updateLogicDetail(key) {
            const data = logicData[key];
            const box = document.getElementById('logic-detail-box');
            const title = document.getElementById('detail-title');
            const desc = document.getElementById('detail-desc');
            const math = document.getElementById('detail-math');

            // Simple fade effect
            box.style.opacity = '0.7';
            setTimeout(() => {
                title.innerText = data.title;
                title.className = `text-xl font-bold mb-2 ${data.color}`;
                desc.innerText = data.desc;
                math.innerText = data.math;
                box.style.opacity = '1';
            }, 150);
        }

        // --- Section 2: TETA Simulation Logic (Simplified for Visuals) ---
        const TetaSim = {
            isRunning: false,
            interval: null,
            epoch: 0,
            maxEpochs: 100,
            populationSize: 30,
            agents: [],
            globalBest: { x: 0, y: 0, val: Infinity },
            
            // Rastrigin Function (2D) - A classic tough optimization problem
            fitness: function(x, y) {
                return 20 + (x*x - 10*Math.cos(2*Math.PI*x)) + (y*y - 10*Math.cos(2*Math.PI*y));
            },

            init: function() {
                this.epoch = 0;
                this.agents = [];
                this.globalBest = { x: 0, y: 0, val: Infinity };
                
                // Initialize random agents between -5.12 and 5.12
                for(let i=0; i<this.populationSize; i++) {
                    const x = (Math.random() * 10.24) - 5.12;
                    const y = (Math.random() * 10.24) - 5.12;
                    const val = this.fitness(x, y);
                    
                    this.agents.push({
                        x: x, y: y, val: val, 
                        pBest: {x: x, y: y, val: val} // History
                    });

                    if (val < this.globalBest.val) {
                        this.globalBest = { x: x, y: y, val: val };
                    }
                }
                
                this.updateUI();
                this.drawPlot();
            },

            step: function() {
                if (this.epoch >= this.maxEpochs) {
                    this.stop();
                    return;
                }
                this.epoch++;

                // Simplified TETA Logic
                this.agents.forEach(agent => {
                    const r = Math.random();
                    let newX, newY;

                    // 1. Future/Random (10% chance)
                    if (r < 0.1) {
                        newX = agent.x + (Math.random() - 0.5) * 2;
                        newY = agent.y + (Math.random() - 0.5) * 2;
                    } 
                    // 2. Past/History (30% chance) - move towards personal best
                    else if (r < 0.4) {
                        newX = agent.x + Math.random() * (agent.pBest.x - agent.x);
                        newY = agent.y + Math.random() * (agent.pBest.y - agent.y);
                    }
                    // 3. Present/Global (60% chance) - move towards global best
                    else {
                        newX = agent.x + Math.random() * (this.globalBest.x - agent.x);
                        newY = agent.y + Math.random() * (this.globalBest.y - agent.y);
                    }

                    // Boundary checks (-5.12 to 5.12)
                    newX = Math.max(-5.12, Math.min(5.12, newX));
                    newY = Math.max(-5.12, Math.min(5.12, newY));

                    // Evaluate
                    const newVal = this.fitness(newX, newY);

                    // Update Agent
                    agent.x = newX;
                    agent.y = newY;
                    agent.val = newVal;

                    // Update Personal Best
                    if (newVal < agent.pBest.val) {
                        agent.pBest = { x: newX, y: newY, val: newVal };
                    }

                    // Update Global Best
                    if (newVal < this.globalBest.val) {
                        this.globalBest = { x: newX, y: newY, val: newVal };
                    }
                });

                this.updateUI();
                this.animatePlot();
            },

            start: function() {
                if(this.isRunning) return;
                this.isRunning = true;
                this.interval = setInterval(() => this.step(), 100);
                document.getElementById('sim-start-btn').innerText = "â¸ æš‚åœ";
                document.getElementById('sim-start-btn').classList.replace('bg-green-600', 'bg-orange-500');
                document.getElementById('sim-start-btn').classList.replace('hover:bg-green-700', 'hover:bg-orange-600');
            },

            stop: function() {
                this.isRunning = false;
                clearInterval(this.interval);
                document.getElementById('sim-start-btn').innerText = "â–¶ ç»§ç»­";
                document.getElementById('sim-start-btn').classList.replace('bg-orange-500', 'bg-green-600');
                document.getElementById('sim-start-btn').classList.replace('hover:bg-orange-600', 'hover:bg-green-700');
            },

            reset: function() {
                this.stop();
                this.init();
                document.getElementById('sim-start-btn').innerText = "â–¶ å¼€å§‹";
            },

            updateUI: function() {
                document.getElementById('sim-epoch').innerText = this.epoch;
                document.getElementById('sim-fitness').innerText = this.globalBest.val.toFixed(4);
            },

            // Setup Plotly Contour
            drawPlot: function() {
                // Generate Contour Data
                const size = 100;
                const x = [], y = [], z = [];
                for(let i=0; i<size; i++) {
                    const xi = -5.12 + (10.24 * i / size);
                    x.push(xi);
                    y.push(xi);
                    const zRow = [];
                    for(let j=0; j<size; j++) {
                        const yj = -5.12 + (10.24 * j / size);
                        zRow.push(this.fitness(xi, yj));
                    }
                    z.push(zRow);
                }

                const contour = {
                    z: z, x: x, y: y,
                    type: 'contour',
                    colorscale: 'Viridis',
                    showscale: false,
                    contours: { showlines: false }
                };

                const agentsTrace = {
                    x: this.agents.map(a => a.x),
                    y: this.agents.map(a => a.y),
                    mode: 'markers',
                    type: 'scatter',
                    marker: { color: 'red', size: 8, symbol: 'x' },
                    name: 'Travelers'
                };

                const bestTrace = {
                    x: [this.globalBest.x],
                    y: [this.globalBest.y],
                    mode: 'markers',
                    type: 'scatter',
                    marker: { color: 'white', size: 12, line: {color: 'black', width: 2} },
                    name: 'Best'
                };

                const layout = {
                    title: false,
                    autosize: true,
                    margin: {l: 30, r: 30, b: 30, t: 20},
                    hovermode: false,
                    xaxis: {range: [-5.12, 5.12]},
                    yaxis: {range: [-5.12, 5.12]}
                };

                const config = { responsive: true, displayModeBar: false };

                Plotly.newPlot('plotly-div', [contour, agentsTrace, bestTrace], layout, config);
            },

            animatePlot: function() {
                Plotly.animate('plotly-div', {
                    data: [{}, // Contour (no change)
                        { x: this.agents.map(a => a.x), y: this.agents.map(a => a.y) },
                        { x: [this.globalBest.x], y: [this.globalBest.y] }
                    ],
                    traces: [0, 1, 2],
                    layout: {}
                }, {
                    transition: { duration: 50 },
                    frame: { duration: 50, redraw: false }
                });
            }
        };

        // --- Section 3: Benchmark Charts (Chart.js) ---
        function initCharts() {
            // 1. Convergence Line Chart
            const ctxLine = document.getElementById('convergenceChart').getContext('2d');
            
            // Mock Data based on typical Algorithmic behavior
            const labels = Array.from({length: 20}, (_, i) => i * 5);
            const dataTETA = labels.map(i => 100 * Math.exp(-0.15 * i) + Math.random());
            const dataPSO = labels.map(i => 100 * Math.exp(-0.08 * i) + 5 + Math.random());
            const dataGA = labels.map(i => 100 * Math.exp(-0.05 * i) + 10 + Math.random());

            new Chart(ctxLine, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'TETA (Proposed)',
                            data: dataTETA,
                            borderColor: '#ea580c', // Orange
                            backgroundColor: 'rgba(234, 88, 12, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            pointRadius: 2
                        },
                        {
                            label: 'PSO (Particle Swarm)',
                            data: dataPSO,
                            borderColor: '#3b82f6', // Blue
                            borderDash: [5, 5],
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'GA (Genetic)',
                            data: dataGA,
                            borderColor: '#78716c', // Stone
                            borderDash: [2, 2],
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(2);
                                }
                            }
                        },
                        legend: { position: 'top' }
                    },
                    scales: {
                        y: {
                            type: 'logarithmic',
                            title: { display: true, text: 'Fitness Value (Log)' },
                            grid: { color: '#f5f5f4' }
                        },
                        x: {
                            title: { display: true, text: 'Epochs' },
                            grid: { display: false }
                        }
                    }
                }
            });

            // 2. Radar Chart
            const ctxRadar = document.getElementById('radarChart').getContext('2d');
            new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: ['æ”¶æ•›é€Ÿåº¦', 'è§£çš„ç²¾åº¦', 'è·³å‡ºå±€éƒ¨æœ€ä¼˜', 'ç¨³å®šæ€§', 'å‚æ•°ç®€æ˜“æ€§'],
                    datasets: [{
                        label: 'TETA',
                        data: [90, 95, 88, 85, 90],
                        fill: true,
                        backgroundColor: 'rgba(234, 88, 12, 0.2)',
                        borderColor: '#ea580c',
                        pointBackgroundColor: '#ea580c',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#ea580c'
                    }, {
                        label: 'Standard PSO',
                        data: [85, 75, 60, 70, 80],
                        fill: true,
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderColor: '#3b82f6',
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: '#e7e5e4' },
                            grid: { color: '#e7e5e4' },
                            suggestedMin: 50,
                            suggestedMax: 100
                        }
                    }
                }
            });
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Logic Card (Default to Present)
            updateLogicDetail('present');
            
            // Initialize Simulation
            TetaSim.init();
            
            // Event Listeners for Sim
            document.getElementById('sim-start-btn').addEventListener('click', () => {
                if(TetaSim.isRunning) TetaSim.stop();
                else TetaSim.start();
            });
            document.getElementById('sim-reset-btn').addEventListener('click', () => TetaSim.reset());

            // Initialize Charts
            initCharts();
        });

    </script>
</body>
</html>